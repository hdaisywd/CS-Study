# 데이터베이스 정규화

> 데이터의 일관성, 최소한의 데이터 중복, 최소한의 데이터 유연성을 위해 사용되며 데이터를 분해하는 과정

비정규화: 읽는 시간을 최적화 / 삽입할 데이터가 많아서 더 많은 저장 공간 필요

![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/d9KQbK/btrj0KexV5J/2RH6az0sCEuWawlLLlhzhk/img.png)

![image](https://velog.velcdn.com/images/wisdom-one/post/43aef4a5-c911-4217-a921-3b0934088326/image.png)

# 장점

- 불필요한 데이터를 제거하여 데이터의 중복을 최소화할 수 있기 때문에 저장공간을 효율적으로 이용할 수 있게 된다.
- 각종 이상 현상(Anomaly)를 방지할 수 있다.
- 테이블 데이터 집합이 논리적, 직관적으로 구성된다. (자료 구조가 안정적으로 변화한다.)
- 다양한 관점에서의 쿼리를 지원한다.
- 데이터 무결성 유지

# 단점

- 릴레이션(관계)의 분해로 릴레이션 간의 참조 연산(JOIN)이 많아져 응답시간이 길어질 수 있다.
- 상대적으로 타 DBMS로의 구조 이식이 어려워진다

# 이상 종류(중복된 자료에 의한 이상 현상)

- 삽입 이상: 데이터 삽입 시 의도와 다른 값들도 삽입됨
- 삭제 이상: 데이터 삭제 시 의도와 다른 값들도 연쇄 삭제됨
- 갱신 이상: 속성값 갱신 시 일부 튜플만 갱신되어 모순 발생

# 함수적 종속

## 완전 함수적 종속

- 어떤 속성이 기본키에 대해 완전히 종속적

## 부분 함수적 종속

- 어떤 테이블 R에서 속성 A가 다른 속성 집합 B 전체에 대해 함수적 종속이면서 속성 집합 B의 어떠한 진부분 집합에도 함수적 종속일 때 속성 A는 속성 집합 B에 부분 함수적 종속

정규화의 과정은 1NF -> 2NF -> 3NF -> BCNF -> 4NF -> 5NF 의 순서

# 1NF

1. 각 컬럼이 하나의 속성만을 가져야 한다.

2. 하나의 컬럼은 같은 종류나 타입(type)의 값을 가져야 한다.

3. 각 컬럼이 유일한(unique) 이름을 가져야 한다.

4. 칼럼의 순서가 상관없어야 한다.

|회원번호|회원이름|프로그램|
|------|---|---|
|101|강호동|요가|
|102|손흥민|헬스|
|103|김민수|헬스, 골프|

WHERE 프로그램 = '골프' -> WHERE 프로그램 LIKE '%골프%' (성능 저하)
프로그램명 수정도 힘듦

|회원번호|회원이름|프로그램|
|------|---|---|
|101|강호동|요가|
|102|손흥민|헬스|
|103|김민수|헬스|
|103|김민수|골프|

# 2NF

1. 1정규형을 만족해야 한다.

2. 모든 컬럼이 부분적 종속(Partial Dependency)이 없어야 한다. == 모든 칼럼이 완전 함수 종속을 만족해야 한다.

Primary Key 행을 서로 구분하기 위한 컬럼

Compostie primary key(회원번호, 프로그램)

|회원번호|회원이름|프로그램|가격|납부여부|
|------|---|---|---|---|
|101|강호동|요가|5000|0|
|102|손흥민|헬스|6000|1|
|103|김민수|헬스|6000|1|
|103|김민수|골프|8000|0|

헬스 가격을 7000원으로 수정하려면?! 너무 많으면 가격 하나 수정하는데 비효율 발생
현재 테이블의 주제와 관련 없는 컬럼을 따로 뺌

|회원번호|회원이름|프로그램|납부여부|
|------|---|---|---|
|101|강호동|요가|0|
|102|손흥민|헬스|1|
|103|김민수|헬스|1|
|103|김민수|골프|0|

|프로그램|가격|
|---|---|
|요가|5000|
|헬스|6000|
|골프|8000|

단점: 손흥민은 얼마 내야 함? 다른 테이블에서 가져와야 함

비관계형 DB는 정규 ㄴㄴ / 관계형 ㅇㅇ

# 3NF

1. 2 정규형을 만족해야 한다.

2. 기본키를 제외한 속성들 간의 이행 종속성 (Transitive Dependency)이 없어야 한다.

|프로그램|가격|강사|출신대학|
|------|---|---|---|
|요가|5000|김을용|서울대|
|헬스|6000|박덕팔|연세대|
|골프|8000|이상구|고려대|
|골프중급|9000|이상구|고려대|
|PT|6000|박덕팔|연세대|

|프로그램|가격|강사|출신대학|
|------|---|---|---|
|요가|5000|김을용|
|헬스|6000|박덕팔|
|골프|8000|이상구|
|골프중급|9000|이상구|
|PT|6000|박덕팔|

|강사|출신대학|
|---|---|
|김을용|서울대|
|박덕팔|연세대|
|이상구|고려대|

이상구가 학벌세탁
단점: 골프 가르치는 사람의 학벌은?!

# BCNF

1. 3정규형을 만족해야 한다.

2. 모든 결정자가 후보키 집합에 속해야 한다.

![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbDpCpQ%2FbtrP9j99LpS%2F4SlIuGmJLNSCsoWvLARRtK%2Fimg.png)

# 4NF

1. BCNF를 만족해야 한다.

2. 다치 종속(Multi-valued Dependency)이 없어야 한다.

![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/7XKzy/btrP7OiNpBW/OGPWeVPSx7KnMvpS4pNOu1/img.png)

# 5NF
**거의 안씀**

1. 4NF를 만족해야 한다.

2. 조인 종속(Join dependency)이 없어야 한다.

3. 조인 연산을 했을 때 손실이 없어야 한다.
