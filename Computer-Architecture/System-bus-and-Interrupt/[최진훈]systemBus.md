# 목차 
[1. System Bus](#System-Bus) <br>
[2. 버스 중재](#버스-중재) <br>
[3. I/O 장치의 접속](#I/O-장치의-접속) <br>
[4. 인터럽트를 이용한 I/O](#인터럽트를-이용한-I/O) <br>
[5. 직접 기억장치 엑세스](#직접-기억장치-엑세스) <br>

# System Bus
* 컴퓨터 시스템의 구성 요소들을 상호 연결해주는 중심 통로

## 시스템 버스의 조직
<br>
사진
<br>

* 버스 - 구성 요소들간에 교환할 각종 정보들을 전송하는 선들로 구성
* 데이터 버스 - CPU와 (기억장치,I/O장치)사이에서 Data를 전달하는 통로 / 양방향
* 주소 버스 - CPU에서 (기억장치 및 I/O 제어기)로 (기억장치 주소, I/O 장치 포트 번호)를 전달하는 통로 / 단반향
* 버스 대역폭 - 버스의 속도를 나타내는 척도 / 버스 클록의 주기에 의해 결정(데이터버스의 폭 / 버스 클록 주기)

## 제어 버스
* 데이터버스, 주소버스를 제어하기 위해 제어신호들을 전송하는 통로 / 양방향
* 기억 장치 쓰기
* 기억 장치 읽기
* I/O 쓰기
* I/O 읽기

#### 중재 버스
* 버스 마스터 - 시스템 버스에 접속되는 요소들 중에서 버스 사용의 주체가 되는 요소들 / ex) CPU, 기억장치, I/O 제어기
* 버스 중재 - 복수의 버스 마스터가 버스를 이용하고자 할때 순서대로 하나씩 쓰게 해주는 동작
* 중재 버스 - 버스 중재를 위하 신호 선들의 집합
    * 버스 요구 신호 (BREQ, Bus REQuest)
    * 버스 승인 신호 (BGNT, Bus GraNT)
    * 버스 사용중 신호 (BBUSY, Bus BUSY)

#### 인터럽트 버스
* 인터럽트 메커니즘을 위한 제어 신호선들의 집합
    * 인터럽트 요구 신호
    * 인터럽트 확인 신호

### 시스템 버스의 기본 동작
* 쓰기 동작 순서 - 버스 마스터가 버스 사용권 획득 / 버스를 통하여 주소와 데이터 및 쓰기 신호 전송
* 읽기 동작 순서 - 버스 마스터가 버스 사용권 획득 / 주소와 읽기 신호를 보내고, 데이터가 올 때까지 대기

#### 동기식 버스와 비동기식 버스의 시간 흐름도
* 동기식 버스 - 공통의 버스 클록 기준으로 동작 / 일반 적인 컴퓨터 시스템
    * 장점 - 인터페이스 회로 간단
    * 단점 - 클록 주기보다 짧은 시간이 걸리는 버스 동작이므로 시간 낭비
* 비동기식 버스 - 발생 시간이 관련된 다른 버스 동작의 발행 여부에 따라 동작 / 소규모 컴퓨터
    * 장점 - 시간 낭비 없음
    * 단점 - 연속적 동작을 처리하기 위한 회로로 복잡함

# 버스 중재
* 버스 경합 - 한 버스에 여러 마스터가 버스 사용 요구하는 현상
* 버스 중재 - 버스 경합 발생 시, 마스터들 스케쥴링
* 버스 중재기 - 버스를 중재하는 하드웨어 모듈
* 제어 신호들의 연결 구조에 따른 중재 방식 분류
    * 병렬 중재 방식 
    * 직렬 중재 방식

## 병렬 중재 방식
### 고정 우선순위 방식
* 중앙집중식 - 모든 버스 마스터들이 하나의 버스 중재기에 접속 / 가까운 순서대로 우선순위
* 분산식 - 모든 버스 마스터들이 중재기를 한 개씩 보유
    * 중재 동작 - 각 중재기는 자신보다 높은 마스터의 요구 신호 받아 검사 / 그들이 버스 사용 요구를 하지 않은 경우에만 자신의 마스터에 승인 신호 발생
    * 장점 - 중재 회로 간단 / 동작 회로 빠름
    * 단점 - 고장 중재기 찾기 어려움 / 하나의 고장이 전체 시스템에 영향을 미칠 수 있음

### 가변 우선순위 방식
* 시스템의 상태에 따라 버스 마스터들의 우선순위를 계속 변화
* 장점 - 모든 마스터들이 공정하게 버스 사용 가능
* 단점 - 중재 회로 복잡

#### 회전 우선순위 방식
* 중재 동작이 끝날 때마다 마스터의 우선순위가 하나씩 내려감
* 가장 낮은 마스터는 최상위 우선순위가 됨

#### 기타 가변 우선순위 방식
* 동등 우선순위 방식 - FIFO 알고리즘
* 임의 우선순위 방식
* 최소-최근 사용 - LRU(Least-Recently-Used)

## 직렬 중재 방식
### 중앙집중식
#### 분산식 직렬 중재 방식
## 폴링 방식
### 하드웨어 폴링 방식
### 소프트웨어 폴링 방식

# I/O 장치의 접속
1. I/O 장치들은 종류에 따라 제어 방법이 서로 다르므로 제어 회로들을 CPU 내부 포함시키는게 불가능
2. I/O 장치 데이터 전송 속도가 CPU에 비해 훨씬 느림
3. I/O 자이와 CPU가 사용하는 데이터 형식의 길이가 서로 다를 수 있음
-> 인터페이스 장치인 I/O 제어기 사용
<br>

* I/O 제어기의 주요 기능
    * I/O 장치의 제어와 타이밍 조정
    * CPU와의 통신
    * I/O 장치와의 통신
    * 데이터 버퍼링 기능 수행
    * 오류 검출

## 상태/제어 레지스터
* 내부적으로 두 개의 레지스터로 구성되지만 주소는 하나만 지정
* 상태 레지스터 - I/O장치의 상태와 오류 검사 결과 등을 나타내는 비트들로 구성 / CPU의 읽기 동작 시 선택
* 제어 레지스터 - CPU가 보낸 I/O 명령 단어를 저장 / CPU의 쓰기 동작 시 선택

## Programmed I/O
* CPU가 반복적으로 I/O 장치의 상태를 검사
* 장점 - 간단하며 별도의 하드웨어가 필요 x
* 단점 - CPU가 I/O 동작에 직접 관여해야 함 (그 동안 다른 일 못함)

## I/O 주소지정
* 각 I/O 장치 당 두개씩의 주소 할당 - 데이터 레지스터의 주소, 상태/제어 레지스터의 주소
* I/O 주소 지정 방법
    * Memory-mapped
    * Isolated

### 기억장치 사상 I/O
* 기억장치 주소 영역의 일부분을 I/O 제어기 내의 레지스터들의 주소로 할당하는 방식
* LOAD, STORE 명령어 등을 I/O 장치 제어에도 사용 가능
* 기억장치 읽기/쓰기 신호를 I/O 읽기/쓰기 신호로 사용 -> 별도의 I/O 제어 신호가 필요하지 않음
* 장점 - 프로그래밍 용이 / 사용 가능 명령어들이 다양
* 단점 - 기억장치 주소 공간이 감소

### 분리형 I/O
* I/O 장치 주소공간을 기억장치 주소 공간과는 별도로 할당되는 방식
* I/O 제어를 위해서 별도의 I/O 명령어 사용 - IN,OUT 명령어
* 장점 - 기억장치 주소 공간이 줄어들지 않음
* 단점 - I/O 제어를 위한 I/O 명령어들만 이용할 수 있으므로 프로그래밍이 불편

# 인터럽트를 이용한 I/O
* 인터럽트 - 구동 I/O
    * 인터럽트 메커니즘 이용
    * I/O 동작이 진행되는 동안에 CPU가 다른 작업을 처리

## 다중 인터럽트 방식
* 인터럽트 요구선 (INTR)
* 인터럽트 확인선 (INTA)
* 장점 - CPU가 인터럽트를 요구한 장치를 쉽게 찾아낼 수 있음
* 단점 - 하드웨어 복잡, I/O 장치들 수가 CPU 인터럽트 요구 입력 핀의 수에 의해 제한됨

## 데이지-체인 방식
* CPU로 부터 발생되는 INTA 출력 선을 I/O 제어기에 직렬로 접속하는 방식 / 인터럽트 요구한 I/O 장치는 A In 입력을 받는 즉시 고유ID번호(= 인터럽트 벡터)를 CPU로 전송
* 장점 - 하드웨어가 간단
* 단점 - Starvation

## 소프트웨어 폴링 방식
* TEST I/O선 이용하여 인터럽트를 요구한 장치 검사 / 검사 순서가 우선순위를 결정
* 장점 - 우선순위의 변경이 용이
* 단점 - 처리 시간이 오래 걸림

# 직접 기억장치 엑세스(DMA)
* CPU의 개입 없이 I/O 장치와 기억장치 사이에 데이터를 전송하는 방식
* 방법 - CPU가 주기억장치에 접근하지 않는 시간 동안 시스템 버스를 사용하여 주기억장치와 I/O 장치 간에 데이터 전송
* DMA 처리 순서
1. CPU가 DMA로 아래 명령 전송
    * I/O 장치 주소
    * 연산 지정자
    * 메모리 시작 주소
    * 전송될 데이터 word 수
2. DMA는 CPU로 BREQ 전송
3. CPU는 DMA로 BGNT 전송
4. DMA 제어기가 주기억장치로부터 데이터 읽어서, 디스크 제어기로 전송
5. 저장할 데이터 남아있다면, 그 수만큼 2~4번 반복
6. 모든 데이터 저장 완료되면, CPU로 INTR 전송
* 문제점
    * I/O 장치는 종류/속도 다양, 간단한 DMA로는 한계있음
    * 내부 기억장치 필요
* 해결책 - I/O 프로세서 사용해야 함

## IOP(I/O Processor)
* I/O 제어 프로그램을 수행할 수 있는 프로세서
* 시스템 버스 인터페이스
* 버스 마스터 회로
* I/O 버스 중재 회로
